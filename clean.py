import pandas as pd

import xlsxwriter

xls = pd.ExcelFile('POS.xlsx')
df1 = pd.read_excel(xls, 'POS DATA')
df2 = pd.read_excel(xls, 'LOYALTY')
df3 = pd.read_excel(xls, 'BARCODES')
df4 = pd.read_excel(xls, 'Categories Hierarchy')

df1['CategoryC'].replace(265,264,inplace=True)
df1['CategoryC'].replace(282,281,inplace=True)
df1['CategoryC'].replace(283,281,inplace=True)
df1['CategoryC'].replace(266,264,inplace=True)
df1['CategoryC'].replace(267,264,inplace=True)
df1['CategoryC'].replace(269,268,inplace=True)
df1['CategoryC'].replace(270,268,inplace=True)
df1['CategoryC'].replace(202,201,inplace=True)
df1['CategoryC'].replace(161,201,inplace=True)
df1['CategoryC'].replace(162,201,inplace=True)
df1['CategoryC'].replace(163,201,inplace=True)
df1['CategoryC'].replace(168,201,inplace=True)
df1['CategoryC'].replace(169,201,inplace=True)
df1['CategoryC'].replace(207,206,inplace=True)
df1['CategoryC'].replace(188,206,inplace=True)
df1['CategoryC'].replace(210,208,inplace=True)
df1['CategoryC'].replace(213,211,inplace=True)
df1['CategoryC'].replace(167,211,inplace=True)
df1['CategoryC'].replace(235,234,inplace=True)
df1['CategoryC'].replace(236,234,inplace=True)
df1['CategoryC'].replace(237,234,inplace=True)
df1['CategoryC'].replace(111,110,inplace=True)
df1['CategoryC'].replace(115,110,inplace=True)
df1['CategoryC'].replace(116,110,inplace=True)
df1['CategoryC'].replace(216,110,inplace=True)
df1['CategoryC'].replace(1,110,inplace=True)
df1['CategoryC'].replace(2,110,inplace=True)
df1['CategoryC'].replace(4,110,inplace=True)
df1['CategoryC'].replace(5,110,inplace=True)
df1['CategoryC'].replace(8,110,inplace=True)
df1['CategoryC'].replace(19,110,inplace=True)
df1['CategoryC'].replace(20,110,inplace=True)
df1['CategoryC'].replace(22,110,inplace=True)
df1['CategoryC'].replace(60,600,inplace=True)
df1['CategoryC'].replace(61,600,inplace=True)
df1['CategoryC'].replace(62,600,inplace=True)
df1['CategoryC'].replace(63,600,inplace=True)
df1['CategoryC'].replace(64,600,inplace=True)
df1['CategoryC'].replace(65,600,inplace=True)
df1['CategoryC'].replace(66,600,inplace=True)
df1['CategoryC'].replace(67,600,inplace=True)
df1['CategoryC'].replace(68,600,inplace=True)
df1['CategoryC'].replace(69,600,inplace=True)
df1['CategoryC'].replace(70,600,inplace=True)
df1['CategoryC'].replace(131,600,inplace=True)
df1['CategoryC'].replace(132,600,inplace=True)
df1['CategoryC'].replace(133,600,inplace=True)
df1['CategoryC'].replace(134,600,inplace=True)
df1['CategoryC'].replace(135,600,inplace=True)
df1['CategoryC'].replace(136,600,inplace=True)
df1['CategoryC'].replace(137,600,inplace=True)
df1['CategoryC'].replace(138,600,inplace=True)
df1['CategoryC'].replace(139,600,inplace=True)
df1['CategoryC'].replace(140,600,inplace=True)
df1['CategoryC'].replace(141,600,inplace=True)
df1['CategoryC'].replace(33,600,inplace=True)
df1['CategoryC'].replace(14,600,inplace=True)
df1['CategoryC'].replace(50,600,inplace=True)
df1['CategoryC'].replace(51,600,inplace=True)
df1['CategoryC'].replace(52,600,inplace=True)
df1['CategoryC'].replace(56,600,inplace=True)
df1['CategoryC'].replace(57,600,inplace=True)
df1['CategoryC'].replace(58,600,inplace=True)
df1['CategoryC'].replace(41,13,inplace=True)
df1['CategoryC'].replace(42,13,inplace=True)
df1['CategoryC'].replace(43,13,inplace=True)
df1['CategoryC'].replace(44,13,inplace=True)
df1['CategoryC'].replace(80,15,inplace=True)
df1['CategoryC'].replace(81,15,inplace=True)
df1['CategoryC'].replace(82,15,inplace=True)
df1['CategoryC'].replace(83,15,inplace=True)
df1['CategoryC'].replace(84,15,inplace=True)
df1['CategoryC'].replace(85,15,inplace=True)
df1['CategoryC'].replace(86,15,inplace=True)
df1['CategoryC'].replace(87,15,inplace=True)
df1['CategoryC'].replace(88,15,inplace=True)
df1['CategoryC'].replace(89,15,inplace=True)
df1['CategoryC'].replace(90,24,inplace=True)
df1['CategoryC'].replace(91,24,inplace=True)
df1['CategoryC'].replace(92,24,inplace=True)
df1['CategoryC'].replace(324,325,inplace=True)
df1['CategoryC'].replace(371,370,inplace=True)
df1['CategoryC'].replace(373,370,inplace=True)
df1['CategoryC'].replace(374,370,inplace=True)
df1['CategoryC'].replace(379,370,inplace=True)
df1['CategoryC'].replace(376,375,inplace=True)
df1['CategoryC'].replace(377,375,inplace=True)
df1['CategoryC'].replace(378,375,inplace=True)
df1['CategoryC'].replace(328,338,inplace=True)
df1['CategoryC'].replace(381,380,inplace=True)
df1['CategoryC'].replace(382,380,inplace=True)
df1['CategoryC'].replace(383,380,inplace=True)
df1['CategoryC'].replace(385,380,inplace=True)
df1['CategoryC'].replace(386,380,inplace=True)
df1['CategoryC'].replace(387,380,inplace=True)
df1['CategoryC'].replace(388,380,inplace=True)
df1['CategoryC'].replace(389,380,inplace=True)
df1['CategoryC'].replace(347,346,inplace=True)
df1['CategoryC'].replace(378,346,inplace=True)
df1['CategoryC'].replace(349,346,inplace=True)
df1['CategoryC'].replace(804,805,inplace=True)
df1['CategoryC'].replace(402,400,inplace=True)
df1['CategoryC'].replace(404,400,inplace=True)
df1['CategoryC'].replace(406,400,inplace=True)
df1['CategoryC'].replace(408,400,inplace=True)
df1['CategoryC'].replace(410,400,inplace=True)
df1['CategoryC'].replace(412,400,inplace=True)
df1['CategoryC'].replace(413,400,inplace=True)
df1['CategoryC'].replace(415,400,inplace=True)
df1['CategoryC'].replace(416,400,inplace=True)
df1['CategoryC'].replace(418,400,inplace=True)
df1['CategoryC'].replace(419,400,inplace=True)
df1['CategoryC'].replace(763,400,inplace=True)
df1['CategoryC'].replace(755,400,inplace=True)
df1['CategoryC'].replace(783,400,inplace=True)
df1['CategoryC'].replace(721,400,inplace=True)
df1['CategoryC'].replace(722,400,inplace=True)
df1['CategoryC'].replace(723,400,inplace=True)
df1['CategoryC'].replace(724,400,inplace=True)
df1['CategoryC'].replace(725,400,inplace=True)
df1['CategoryC'].replace(726,400,inplace=True)
df1['CategoryC'].replace(727,400,inplace=True)
df1['CategoryC'].replace(728,400,inplace=True)
df1['CategoryC'].replace(729,400,inplace=True)
df1['CategoryC'].replace(730,400,inplace=True)
df1['CategoryC'].replace(552,551,inplace=True)
df1['CategoryC'].replace(553,551,inplace=True)
df1['CategoryC'].replace(554,551,inplace=True)
df1['CategoryC'].replace(555,551,inplace=True)
df1['CategoryC'].replace(556,551,inplace=True)
df1['CategoryC'].replace(557,551,inplace=True)
df1['CategoryC'].replace(558,551,inplace=True)
df1['CategoryC'].replace(559,551,inplace=True)
df1['CategoryC'].replace(560,551,inplace=True)
df1['CategoryC'].replace(561,551,inplace=True)
df1['CategoryC'].replace(562,551,inplace=True)
df1['CategoryC'].replace(563,551,inplace=True)
df1['CategoryC'].replace(564,551,inplace=True)
df1['CategoryC'].replace(565,551,inplace=True)
df1['CategoryC'].replace(566,551,inplace=True)
df1['CategoryC'].replace(568,551,inplace=True)
df1['CategoryC'].replace(569,551,inplace=True)
df1['CategoryC'].replace(570,551,inplace=True)
df1['CategoryC'].replace(571,551,inplace=True)
df1['CategoryC'].replace(765,551,inplace=True)
df1['CategoryC'].replace(767,551,inplace=True)
df1['CategoryC'].replace(776,551,inplace=True)
df1['CategoryC'].replace(780,551,inplace=True)
df1['CategoryC'].replace(486,485,inplace=True)
df1['CategoryC'].replace(487,485,inplace=True)
df1['CategoryC'].replace(488,485,inplace=True)
df1['CategoryC'].replace(489,485,inplace=True)
df1['CategoryC'].replace(490,485,inplace=True)
df1['CategoryC'].replace(492,485,inplace=True)
df1['CategoryC'].replace(494,485,inplace=True)
df1['CategoryC'].replace(496,485,inplace=True)
df1['CategoryC'].replace(498,485,inplace=True)
df1['CategoryC'].replace(500,485,inplace=True)
df1['CategoryC'].replace(502,485,inplace=True)
df1['CategoryC'].replace(504,485,inplace=True)
df1['CategoryC'].replace(506,485,inplace=True)
df1['CategoryC'].replace(508,485,inplace=True)
df1['CategoryC'].replace(509,485,inplace=True)
df1['CategoryC'].replace(769,485,inplace=True)
df1['CategoryC'].replace(777,485,inplace=True)
df1['CategoryC'].replace(784,485,inplace=True)
df1['CategoryC'].replace(518,516,inplace=True)
df1['CategoryC'].replace(519,516,inplace=True)
df1['CategoryC'].replace(521,516,inplace=True)
df1['CategoryC'].replace(523,516,inplace=True)
df1['CategoryC'].replace(525,516,inplace=True)
df1['CategoryC'].replace(527,516,inplace=True)
df1['CategoryC'].replace(528,516,inplace=True)
df1['CategoryC'].replace(529,516,inplace=True)
df1['CategoryC'].replace(531,516,inplace=True)
df1['CategoryC'].replace(533,516,inplace=True)
df1['CategoryC'].replace(534,516,inplace=True)
df1['CategoryC'].replace(536,516,inplace=True)
df1['CategoryC'].replace(537,516,inplace=True)
df1['CategoryC'].replace(771,516,inplace=True)
df1['CategoryC'].replace(778,516,inplace=True)
df1['CategoryC'].replace(786,516,inplace=True)
df1['CategoryC'].replace(651,650,inplace=True)
df1['CategoryC'].replace(653,650,inplace=True)
df1['CategoryC'].replace(654,650,inplace=True)
df1['CategoryC'].replace(655,650,inplace=True)
df1['CategoryC'].replace(656,650,inplace=True)
df1['CategoryC'].replace(657,650,inplace=True)
df1['CategoryC'].replace(658,650,inplace=True)
df1['CategoryC'].replace(659,650,inplace=True)
df1['CategoryC'].replace(660,650,inplace=True)
df1['CategoryC'].replace(661,650,inplace=True)
df1['CategoryC'].replace(910,911,inplace=True)
df1['CategoryC'].replace(912,911,inplace=True)
df1['CategoryC'].replace(913,911,inplace=True)
df1['CategoryC'].replace(914,911,inplace=True)
df1['CategoryC'].replace(915,911,inplace=True)
df1['CategoryC'].replace(916,911,inplace=True)
df1['CategoryC'].replace(917,911,inplace=True)
df1['CategoryC'].replace(918,911,inplace=True)
df1['CategoryC'].replace(919,911,inplace=True)
df1['CategoryC'].replace(920,911,inplace=True)
df1['CategoryC'].replace(107,106,inplace=True)
df1['CategoryC'].replace(152,151,inplace=True)
df1['CategoryC'].replace(153,151,inplace=True)
df1['CategoryC'].replace(154,151,inplace=True)
df1['CategoryC'].replace(155,151,inplace=True)
df1['CategoryC'].replace(156,151,inplace=True)
df1['CategoryC'].replace(157,151,inplace=True)
df1['CategoryC'].replace(158,151,inplace=True)
df1['CategoryC'].replace(171,166,inplace=True)
df1['CategoryC'].replace(172,166,inplace=True)
df1['CategoryC'].replace(173,166,inplace=True)
df1['CategoryC'].replace(174,166,inplace=True)
df1['CategoryC'].replace(841,840,inplace=True)
df1['CategoryC'].replace(842,840,inplace=True)
df1['CategoryC'].replace(843,840,inplace=True)
df1['CategoryC'].replace(844,840,inplace=True)
df1['CategoryC'].replace(845,840,inplace=True)
df1['CategoryC'].replace(846,840,inplace=True)
df1['CategoryC'].replace(847,840,inplace=True)
df1['CategoryC'].replace(848,840,inplace=True)
df1['CategoryC'].replace(314,315,inplace=True)
df1['CategoryC'].replace(317,315,inplace=True)
df1['CategoryC'].replace(316,315,inplace=True)
df1['CategoryC'].replace(318,315,inplace=True)
df1['CategoryC'].replace(319,315,inplace=True)
df1['CategoryC'].replace(800,315,inplace=True)
df1['CategoryC'].replace(801,315,inplace=True)
df1['CategoryC'].replace(802,315,inplace=True)
df1['CategoryC'].replace(803,315,inplace=True)
df1['CategoryC'].replace(325,324,inplace=True)
df1['CategoryC'].replace(333,331,inplace=True)

df1 = pd.merge(df1,df4,on='CategoryC',how='left')








writer = pd.ExcelWriter('POS.xlsx', engine='xlsxwriter')

df1.to_excel(writer, sheet_name='POS DATA')
df2.to_excel(writer, sheet_name='LOYALTY')
df3.to_excel(writer, sheet_name='BARCODES')
df4.to_excel(writer, sheet_name='Categories Hierarchy')

writer.save()